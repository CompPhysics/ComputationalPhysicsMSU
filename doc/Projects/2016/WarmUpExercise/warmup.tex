\documentclass[11pt,a4wide]{article}
\usepackage{verbatim}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{a4wide}
\usepackage{color}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[dvips]{epsfig}
\usepackage[T1]{fontenc}
\usepackage{cite} % [2,3,4] --> [2--4]
\usepackage{shadow}
\usepackage{hyperref}

\setcounter{tocdepth}{2}

\lstset{language=c++}
\lstset{alsolanguage=[90]Fortran}
\lstset{basicstyle=\small}
\lstset{backgroundcolor=\color{white}}
\lstset{frame=single}
\lstset{stringstyle=\ttfamily}
\lstset{keywordstyle=\color{red}\bfseries}
\lstset{commentstyle=\itshape\color{blue}}
\lstset{showspaces=false}
\lstset{showstringspaces=false}
\lstset{showtabs=false}
\lstset{breaklines}
\begin{document}
\section*{Warm up exercise}

We want you to compute the first derivative of
\[
   f(x)=tan^{-1}(x) 
\]
for $x=\sqrt{2}$ with step lengths $h$. 
The exact answer is
$1/3$.
We want you to code the derivative using the following two
formulae 
\begin{equation}
    f'_{2c}(x)= \frac{f(x+h)-f(x)}{h}+O(h),
\label{eq:ex31a}
\end{equation}
and 
\begin{equation} 
   f'_{3c}=\frac{f_h-f_{-h}}{2h}+O(h^2),
\label{eq:ex31b}
\end{equation}
with $f_{\pm h}=f(x\pm h)$.



\begin{enumerate}
\item Find mathematical expressions for the total error due to loss
of precision and due to the numerical approximation made.
Find the step length which gives the smallest value.
Perform the analysis with both double and single precision.

\item Make thereafter a program 
which computes the first derivative using Eqs.~(\ref{eq:ex31a}) and (\ref{eq:ex31b}) 
as function of various step lengths $h$ and let $h\rightarrow 0$.
Compare with the exact answer.

Your program should contain the following elements:  
\begin{itemize}
 \item A vector (array)  which contains the step lengths. 
Use dynamic memory allocation.
 \item Vectors for the computed derivatives of Eqs.~(\ref{eq:ex31a}) and (\ref{eq:ex31b}) 
for both single and double precision.
\item A function which computes the derivative and contains call by value and reference 
(for C++ users only).

 \item Add a function which writes the results to file.
\end{itemize}
\item Compute thereafter
\[
   \epsilon=log_{10}\left(\left|\frac{f'_{\mathrm{computed}}-f'_{\mathrm{exact}}}
                 {f'_{\mathrm{exact}}}\right|\right),
\]
as function of  $log_{10}(h)$ for Eqs.~(\ref{eq:ex31a}) and (\ref{eq:ex31b})  
for both single and double precision.
Plot the results and see if you can determine empirically 
the behavior of the total error as function of $h$.
\end{enumerate}


\end{document}

